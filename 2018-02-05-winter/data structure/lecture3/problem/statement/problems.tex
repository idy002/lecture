\documentclass[11pt,a4paper,oneside]{article}
\usepackage[english]{babel}
\usepackage{olymp}
\usepackage[dvips]{graphicx}
\usepackage{color}
\usepackage{colortbl}
%\usepackage{expdlist}
%\usepackage{mfpic}
%\usepackage{comment}
\usepackage{multirow}

\usepackage{xeCJK}

%\setCJKmainfont[BoldFont={Hei}]
%{SimSun}
%\setCJKmonofont{FangSong}

\renewcommand{\contestname}{
No.7 High School Winter Training - Data Structure 3 \\
idy002, \today
}    

\begin{document}
	
	\begin{problem}{subtree}{subtree.in}{subtree.out}{1 second} 
		
		给出一棵$N$个点的有根树（以$1$为根），每个点有点权，要求支持：
		
		\begin{itemize}
			\item \texttt{modify u x} 把节点$u$的点权加$x$
			\item \texttt{query u} 询问$u$代表的子树的点权和
		\end{itemize}
		
		\InputFile
		
		第$1$行，一个整数$N$。
		
		第$2$行，有$N$个整数：$a_1,a_2,\dots,a_N$，表示每个点最开始的权值。
		
		接下来$N-1$行，每行两个数：$u \; v$，表示一条边。
		
		接下来$1$行，一个整数$Q$，表示操作数。
		
		接下来$Q$行，每行代表一个操作（格式如上）。
		
		\OutputFile
		
		对于每个询问，输出其结果。
		
		\Example
		
		\begin{example}
			\exmp{
				5
				5 4 3 2 1
				1 2
				1 3
				3 4
				3 5
				3
				query 1
				modify 1 -5
				query 1
			}{
				15
				10
			}%
	\end{example}
	
	
	\Note
	
	\begin{itemize}
		\item 对于$30\%$的数据，$1 \leq N, Q \leq 10^3$
		\item 对于$100\%$的数据，$ 1 \leq N, Q \leq 10^5$，$|a_i| , | x | \leq 10^5 $，$ 1 \leq u \leq N $
	\end{itemize}
	
\end{problem}
	
	\begin{problem}{setsum}{setsum.in}{setsum.out}{1 second} 
		
		给你一个长度为$N$的整数序列，支持两种操作：
		
		\begin{itemize}
			\item \texttt{modity l r val} 将区间$[l,r]$中的所有数修改为$val$
			\item \texttt{query l r} 询问区间$[l,r]$所有数的和
		\end{itemize}
		
		\InputFile
		
		第$1$行，一个整数$N$，表示序列长度。
		
		第$2$行，有$N$个整数：$a_1,a_2,\dots,a_N$ 表示给定序列。
		
		第$3$行，有$1$个整数$Q$，表示操作数。
		
		接下来$Q$行，每行为一个操作。
		
		\OutputFile
		
		对于每个询问， 输出其答案。
		
		\Example
		
		\begin{example}
			\exmp{
				5
				3 2 5 1 4
				3
				query 2 3
				modify 2 3 3
				query 1 3
			}{
			7
			9
		}%
	\end{example}
	
	\Note
	
	\begin{itemize}
		\item 对于$30\%$的数据，$1 \leq N, Q \leq 10^3$
		\item 对于$100\%$的数据，$1 \leq N, Q \leq 10^5$，$ 1 \leq val \leq 5000$，
		$ 1 \leq a_i \leq 5000 $
	\end{itemize}
	
\end{problem}

\begin{problem}{dcplca}{dcplca.in}{dcplca.out}{1 second}
	
	这是一道练习题，要求你们用链剖来写lca，熟悉链剖的过程。（以节点$1$为根）
	
	\InputFile
	
	第$1$行，一个整数$N$，表示树的节点个数。
	
	接下来$N - 1$行，每行两个数：$u, v$，表示一条边
	
	接下来$1$行，一个整数$Q$，表示询问数。
	
	接下来$Q$行，每行两个整数，$u, v$，表示询问节点$u$和$v$的lca。
	
	\OutputFile
	
	对于每个询问，输出lca的节点编号。
	
	\Example
	
	\begin{example}
		\exmp{
			5
			1 2
			1 3
			2 4
			2 5
			2
			4 5
			3 5
		}{
			2
			1		
	}%
\end{example}

\Note

\begin{itemize}
	\item 对于$100\%$的数据，$1 \leq N, Q \leq 10^5$，$1 \leq u, v \leq N$
\end{itemize}
注意：内存限制为$32MB$。

\end{problem}

\begin{problem}{full}{full.in}{full.out}{2 second} 
	
	我们来个完全版如何？
	
	给你棵带点权的树（以$1$为根），要你完成一些操作。
	
	\begin{itemize}
		\item \texttt{msub u x}：将$u$代表的子树的点权整体加$x$
		\item \texttt{mpth u v x}：将$u$到$v$的简单路径的点权整体加$x$
		\item \texttt{qsub u}：询问子树$u$的点权和
		\item \texttt{qpth u v}：询问路径$u$到$v$的点权和
	\end{itemize}
	
	\InputFile
	
	第$1$行，一个整数$N$，表示树的大小。
	
	第$2$行，$N$个整数：$a_1,a_2,\dots,a_n$表示初始点权
	
	接下来$N - 1$行，每行两个整数：$u, v$表示一条边
	
	接下来$1$行，一个整数$Q$表示操作数。
	
	接下来$Q$行，每行是上面四个操作之一。
	
	\OutputFile
	
	对于每个询问，输出其对应结果。
	
	\Example
	
	\begin{example}
		\exmp{
			5
			1 2 3 4 5
			1 2
			1 3
			2 4
			2 5
			4
			msub 1 1
			mpth 2 5 1
			qsub 1
			qpth 3 5 
		}{
			22
			17
		}%
\end{example}

\Note

\begin{itemize}
	\item 对于$30\%$的数据，$1 \leq N, Q \leq 10^3$
	\item 对于$100\%$的数据，$1 \leq N, Q \leq 10^5$，$1 \leq u, v \leq N$，$1 \leq a_i, x \leq 10^5$
\end{itemize}

\end{problem}

\end{document}
